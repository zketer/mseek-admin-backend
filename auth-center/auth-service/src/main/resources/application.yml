spring:
  application:
    name: auth-service
  profiles:
    active: local
  cloud:
    openfeign:
      client:
        config:
          default:
            connect-timeout: 5000
            read-timeout: 10000
            logger-level: basic
          user-service:
            connect-timeout: 3000
            read-timeout: 8000
            logger-level: full
      httpclient:
        enabled: true
        max-connections: 200
        max-connections-per-route: 50
        connection-timeout: 5000
        connection-timer-repeat: 30000
      compression:
        request:
          enabled: true
        response:
          enabled: true

  # Flyway 数据库版本管理配置
  flyway:
    enabled: false  # 暂时禁用Flyway，因为不支持MySQL 9.3
    locations: classpath:db/migration
    baseline-on-migrate: true
    baseline-version: 0
    validate-on-migrate: false
    out-of-order: false
    clean-disabled: true
    table: flyway_schema_history
    encoding: UTF-8
    sql-migration-prefix: V
    sql-migration-separator: __
    sql-migration-suffixes: .sql

server:
  port: 8001
  servlet:
    context-path: /api/v1/auth

springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html

# MyBatis Plus配置
mybatis-plus:
  # mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.lynn.museum.auth.model.entity
  configuration:
    map-underscore-to-camel-case: true
    # log-impl: org.apache.ibatis.logging.stdout.StdOutImpl  # 关闭 SQL 详细日志
  global-config:
    db-config:
      logic-delete-field: deleted # 全局逻辑删除字段
      logic-delete-value: 1 # 逻辑已删除值(默认为 1)
      logic-not-delete-value: 0 # 逻辑未删除值(默认为 0)

# 管理端点配置
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
      base-path: /actuator
  endpoint:
    health:
      show-details: always
      show-components: always
  health:
    db:
      enabled: false
    redis:
      enabled: false